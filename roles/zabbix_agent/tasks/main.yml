---
# tasks file for zabbix-agent
# https://github.com/ansible-collections/community.zabbix/blob/main/docs/ZABBIX_AGENT_ROLE.md
- name: Install zabbix agent
  ansible.builtin.include_role:
    name: community.zabbix.zabbix_agent
  vars:
    zabbix_agent_version: "6.4"
    zabbix_agent2: true
    zabbix_agent2_server: "{{ zabbix_server | default('0.0.0.0/0') }}"
    zabbix_agent2_tlsaccept: "{{ tls_accept | default('psk') }}"
    zabbix_agent2_tlspskfile: "/etc/zabbix/zabbix.psk"
    zabbix_agent2_tlspskidentity: "{{ tls_identity }}"
    zabbix_agent2_tlspsk_secret: "{{ tls_psk }}"
    zabbix_api_server_host: "{{ zabbix_host }}"
    zabbix_api_server_port: "{{ zabbix_port | default('443') }}"
    zabbix_api_use_ssl: "{{ use_ssl | default(true) }}"
    zabbix_api_validate_certs: "{{ validate_certs | default(true) }}"
    zabbix_api_login_user: "{{ api_user | default() }}"
    zabbix_api_login_pass: "{{ api_password }}"
    zabbix_useuip: "{{ use_ip }}"
    zabbix_api_create_hosts: "{{ create_hosts }}"
    zabbix_host_groups: "{{ host_groups }}"
    zabbix_agent_link_templates: "{{ templates }}"
    # zabbix_agent_listenip: "0.0.0.0"
    # zabbix_agent_hostname: "{{ hostname }}"
